# ─────────────────────────────────────────
# SNIPER Framework Configuration
# ─────────────────────────────────────────

project:
  name: ""                         # Set by /sniper-init
  type: saas                       # saas | api | mobile | cli | library | monorepo
  description: ""                  # One-line project description

stack:
  language: typescript             # Primary language
  frontend: react                  # Frontend framework (null if none)
  backend: node-express            # Backend framework
  database: postgresql             # Primary database
  cache: redis                     # Cache layer (null if none)
  infrastructure: aws              # Cloud provider
  test_runner: vitest              # Test framework
  package_manager: pnpm            # Package manager

# ─────────────────────────────────────────
# Review Gate Configuration
# ─────────────────────────────────────────
# strict  = full stop, human must approve before next phase
# flexible = auto-advance, human reviews async
# auto    = no gate (not recommended for architecture/implementation)

review_gates:
  after_ingest: flexible           # Low risk — reverse-engineered artifacts, auto-advance
  after_discover: flexible         # Low risk — auto-advance
  after_plan: strict               # HIGH RISK — bad architecture cascades
  after_solve: flexible            # Low risk — stories can be refined later
  after_sprint: strict             # HIGH RISK — code must be reviewed before merge

# ─────────────────────────────────────────
# Agent Teams Configuration
# ─────────────────────────────────────────

agent_teams:
  max_teammates: 5                 # Max concurrent teammates (token budget)
  default_model: sonnet            # sonnet | opus — for implementation
  planning_model: opus             # Use Opus for planning & architecture
  delegate_mode: true              # Lead enters delegate mode during team execution
  plan_approval: true              # Require plan approval for complex/risky tasks
  coordination_timeout: 30         # Minutes before lead checks on stalled teammates

# ─────────────────────────────────────────
# Domain Pack
# ─────────────────────────────────────────

domain_packs: []                   # [{name: "sales-dialer", package: "@sniper.ai/pack-sales-dialer"}]

# ─────────────────────────────────────────
# Documentation Generation (/sniper-doc)
# ─────────────────────────────────────────

documentation:
  output_dir: "docs/"              # Where generated docs are written
  managed_sections: true           # Use <!-- sniper:managed --> protocol for incremental updates
  include:                         # Default doc types to generate
    - readme
    - setup
    - architecture
    - api
  exclude: []                      # Doc types to skip

# ─────────────────────────────────────────
# File Ownership Rules
# ─────────────────────────────────────────
# These are injected into spawn prompts to prevent teammates from editing
# each other's files. Customize per project.

ownership:
  backend:
    - "src/backend/"
    - "src/api/"
    - "src/services/"
    - "src/db/"
    - "src/workers/"
  frontend:
    - "src/frontend/"
    - "src/components/"
    - "src/hooks/"
    - "src/styles/"
    - "src/pages/"
  infrastructure:
    - "docker/"
    - ".github/"
    - "infra/"
    - "terraform/"
    - "scripts/"
  tests:
    - "tests/"
    - "__tests__/"
    - "*.test.*"
    - "*.spec.*"
  ai:
    - "src/ai/"
    - "src/ml/"
    - "src/pipeline/"
  docs:
    - "docs/"

# ─────────────────────────────────────────
# Lifecycle State (managed by SNIPER, don't edit manually)
# ─────────────────────────────────────────

schema_version: 2

state:
  # Phase log — tracks all phase runs with context
  # Valid phases: discover | plan | solve | sprint | ingest
  phase_log: []                    # [{phase, context, started_at, completed_at, approved_by}]
  current_sprint: 0

  # Artifact tracking — object format with version
  artifacts:
    brief:
      status: null                 # null | draft | approved
      version: 0
    risks:
      status: null
      version: 0
    personas:
      status: null
      version: 0
    prd:
      status: null
      version: 0
    architecture:
      status: null
      version: 0
    ux_spec:
      status: null
      version: 0
    security:
      status: null
      version: 0
    conventions:
      status: null
      version: 0
    epics:
      status: null
      version: 0
    stories:
      status: null
      version: 0

  # Feature tracking
  feature_counter: 1               # next SNPR-{XXXX} ID to assign
  features: []                     # [{id, slug, title, phase, created_at, completed_at, arch_base_version, stories_total, stories_complete}]

  # Bug tracking
  bug_counter: 1                   # next BUG-{NNN} ID to assign
  bugs: []                         # [{id, title, severity, status, created_at, resolved_at, root_cause, fix_stories}]

  # Refactor tracking
  refactor_counter: 1              # next REF-{NNN} ID to assign
  refactors: []                    # [{id, title, status, created_at, completed_at, scope_dirs, stories_total, stories_complete}]

  # Review tracking
  reviews: []                      # [{id, type, target, recommendation, created_at}]

  # Test audit tracking
  test_audit_counter: 1            # next TST-{NNN} ID to assign
  test_audits: []                  # [{id, title, status, created_at, completed_at, scope_dirs, focus, stories_total, stories_complete}]

  # Security audit tracking
  security_audit_counter: 1        # next SEC-{NNN} ID to assign
  security_audits: []              # [{id, title, status, created_at, completed_at, scope_dirs, focus, findings_critical, findings_high, findings_medium, findings_low, stories_total, stories_complete}]

  # Performance audit tracking
  perf_audit_counter: 1            # next PERF-{NNN} ID to assign
  perf_audits: []                  # [{id, title, status, created_at, completed_at, scope_dirs, focus, stories_total, stories_complete}]
